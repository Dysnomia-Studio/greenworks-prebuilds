environment:
  matrix:
    - nodejs_version: "12.0.0"

platform:
  - x64

os: Visual Studio 2017

build: off

branches:
  only:
    - develop
    - /^v.*$/

# init:
install:
  - ps: Install-Product node $env:nodejs_version $env:platform
  - git clone https://github.com/greenheartgames/greenworks greenworks

  - 7z x sdk.zip -p"%ZIP_PASSWORD%"
  - mv sdk greenworks/deps/steamworks_sdk
  - ls greenworks
  - ls greenworks/deps
  - ls greenworks/deps/steamworks_sdk
  - npm i -g npx
  - npm install

  - mkdir prebuilds
  - cd greenworks
  - npm install
  - mkdir prebuilds
  - cd ..
  - node index.js
  - cp -R greenworks/prebuilds/* prebuilds/
  - npx prebuild --upload-all %GH_TOKEN%
